<!DOCTYPE html>
<html lang="en">

<head>
    <title>Spring API REST</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,500" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/pages/waves/css/waves.min.css" type="text/css" media="all">
    <link rel="stylesheet" type="text/css" href="/assets/icon/themify-icons/themify-icons.css">
    <link rel="stylesheet" type="text/css" href="/assets/icon/icofont/css/icofont.css">
    <link rel="stylesheet" type="text/css" href="/assets/icon/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css"> <!--./assets/css/style.css -->

</head>

<body themebg-pattern="theme1">
<!-- Pre-loader start -->
<div class="theme-loader">

    <div class="loader-track">
        <div class="preloader-wrapper">
            <div class="spinner-layer spinner-blue">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div>
                <div class="gap-patch">
                    <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                    <div class="circle"></div>
                </div>
            </div>
            <div class="spinner-layer spinner-red">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div>
                <div class="gap-patch">
                    <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                    <div class="circle"></div>
                </div>
            </div>

            <div class="spinner-layer spinner-yellow">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div>
                <div class="gap-patch">
                    <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                    <div class="circle"></div>
                </div>
            </div>

            <div class="spinner-layer spinner-green">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div>
                <div class="gap-patch">
                    <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                    <div class="circle"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Pre-loader end -->

<section class="login-block">
    <!-- Container-fluid starts -->
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <!-- Authentication card start -->

                <form class="md-float-material form-material" action="" id="formNewUser">

                    <div class="auth-box card">
                        <div class="card-block">
                            <div class="row m-b-20">
                                <div class="col-md-12">
                                    <h3 class="text-center">Cadastrar Usuário</h3>
                                </div>
                            </div>
                            <div class="form-group form-primary form-static-label">
                                <input type="text" name="id" id="id" class="form-control" readonly>
                                <span class="form-bar"></span>
                                <label class="float-label">ID</label>
                            </div>
                            <div class="form-group form-primary">
                                <input type="text" name="firstName" id="firstName" class="form-control" required>
                                <span class="form-bar"></span>
                                <label class="float-label">Nome</label>
                            </div>
                            <div class="form-group form-primary">
                                <input type="text" name="lastName" id="lastName" class="form-control" required>
                                <span class="form-bar"></span>
                                <label class="float-label">Sobrenome</label>
                            </div>
                            <div class="form-group form-primary">
                                <input type="email" name="email" id="email" class="form-control" required>
                                <span class="form-bar"></span>
                                <label class="float-label">Email</label>
                            </div>
                            <div class="row m-t-30">
                                <div class="col-md-12">
                                    <button type="button" class="btn btn-success btn-md btn-block waves-effect waves-light text-center m-b-20" onclick="saveUser()">Salvar</button>
                                    <button type="button" class="btn btn-primary btn-md btn-block waves-effect waves-light text-center m-b-20" onclick="clearForm()">Novo</button>
                                    <button type="button" class="btn btn-info btn-md btn-block waves-effect waves-light text-center m-b-20" data-bs-toggle="modal" data-bs-target="#exampleModal">Pesquisar</button>
                                    <button type="button" class="btn btn-danger btn-md btn-block waves-effect waves-light text-center m-b-20" onclick="UserDel()">Deletar</button>
                                </div>
                            </div>

                        </div>
                    </div>
                </form>

                <!-- end of form -->
            </div>
            <!-- end of col-sm-12 -->
        </div>
        <!-- end of row -->
    </div>
    <!-- end of container-fluid -->

</section>

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Pesquisar Usuário</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="searchUser" class="col-form-label">Informe o nome:</label>
                        <input type="text" class="form-control" id="searchUser" name="name">
                    </div>
                    <button type="button" class="btn btn-primary" onclick="search()">Buscar</button>
                </form>
                <table class="table" id="tableSearch">
                    <thead>
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Nome</th>
                        <th scope="col">Sobrenome</th>
                        <th scope="col">Editar</th>
                    </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel2">Pesquisar Usuário</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="searchUser" class="col-form-label">Informe o nome:</label>
                        <input type="text" class="form-control" id="searchUser2" name="name">
                    </div>
                    <button type="button" class="btn btn-primary" onclick="search()">Buscar</button>
                </form>
                <table class="table" id="tableSearchDel">
                    <thead>
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Nome</th>
                        <th scope="col">Sobrenome</th>
                        <th scope="col">Editar</th>
                    </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script type="text/javascript" src="./assets/js/jquery/jquery.min.js"></script>
<script type="text/javascript" src="./assets/js/jquery-ui/jquery-ui.min.js "></script>
<script type="text/javascript" src="./assets/js/popper.js/popper.min.js"></script>
<script type="text/javascript" src="./assets/js/bootstrap/js/bootstrap.min.js "></script>
<script src="./assets/pages/waves/js/waves.min.js"></script>
<script type="text/javascript" src="./assets/js/jquery-slimscroll/jquery.slimscroll.js "></script>
<script type="text/javascript" src="./assets/js/SmoothScroll.js"></script>
<script src="assets/js/jquery.mCustomScrollbar.concat.min.js "></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
<!--<script type="text/javascript" src="bower_components/i18next/js/i18next.min.js"></script>-->
<!--<script type="text/javascript" src="bower_components/i18next-xhr-backend/js/i18nextXHRBackend.min.js"></script>-->
<!--<script type="text/javascript" src="bower_components/i18next-browser-languagedetector/js/i18nextBrowserLanguageDetector.min.js"></script>-->
<!--<script type="text/javascript" src="bower_components/jquery-i18next/js/jquery-i18next.min.js"></script>-->
<script type="text/javascript" src="./assets/js/common-pages.js"></script>

<script>

    function search() {
        var name = $("#searchUser").val();
        if (name != null && name.trim() !== "") {
            $.ajax({
                method: "get",
                url: "searchByName",
                data: "name=" + name,
                success: function (response) {
                    $("#tableSearch > tbody > tr").remove();

                    for (var i = 0; i < response.length; i++) {
                        $("#tableSearch > tbody").append("<tr><td>" + response[i].id + "</td><td>" + response[i].firstName + "</td><td>" + response[i].lastName + "</td><td><button onclick=\"edit(" + response[i].id + ")\" type=\"button\" class=\"btn btn-sm btn-outline-success\">Editar</button></td></tr>")
                    }
                },
            }).fail(function (xhr, status, errorThrown) {
                alert("Erro ao pesquisar usuário: " + xhr.responseText);
            });

        }
    }

    function edit(idUser) {
        $.ajax({
            method: "get",
            url: "searchById",
            data: "idUser=" + idUser,
            success: function (response) {
                document.getElementById("id").value = response.id;
                document.getElementById("firstName").value = response.firstName;
                document.getElementById("lastName").value = response.lastName;
                document.getElementById("email").value = response.email;

                $("#exampleModal").modal('hide');
            },
        }).fail(function (xhr, status, errorThrown) {
            alert("Erro ao editar usuário: " + xhr.responseText);
        });
    }


    function UserDel() {
        var id = $("#id").val();
        if (id != null && id.trim() !== "") {
            $.ajax({
                method: "delete",
                url: "deleteUser",
                data: "idUser=" + id,
                success: function (response) {
                    document.getElementById("id").value = "";
                    document.getElementById("firstName").value = "";
                    document.getElementById("lastName").value = "";
                    document.getElementById("email").value = "";
                    alert("Usuário deletado com sucesso.")
                },
            }).fail(function (xhr, status, errorThrown) {
                alert("Erro ao pesquisar usuário: " + xhr.responseText);
            });

        }else {
            alert("Pesquise o usuário.")
        }

    }

    function deleteUser() {
        $.ajax({
            method: "delete",
            url: "searchById",
            data: "idUser=" + idUser,
            success: function (response) {
                document.getElementById("id").value = response.id;
                document.getElementById("firstName").value = response.firstName;
                document.getElementById("lastName").value = response.lastName;
                document.getElementById("email").value = response.email;

                $("#exampleModal").modal('hide');
            },
        }).fail(function (xhr, status, errorThrown) {
            alert("Erro ao editar usuário: " + xhr.responseText);
        });
    }



    function clearForm() {
        document.getElementById("id").value = "";
        document.getElementById("firstName").value = "";
        document.getElementById("lastName").value = "";
        document.getElementById("email").value = "";
    }

    function saveUser() {
        var id = $("#id").val();
        var firstName = $("#firstName").val();
        var lastName = $("#lastName").val();
        var email = $("#email").val();

        $.ajax({
            method: "POST",
            url: "saveUser",
            data: JSON.stringify({
                "id": id,
                "firstName": firstName,
                "lastName": lastName,
                "email": email
            }),
            contentType: "application/json; charset=utf-8",
            success: function (response) {
                $("#id").val(response.id);
                alert("Usuário cadastrado com sucesso.")


            },
        }).fail(function (xhr, status, errorThrown) {
            alert("Erro ao salvar usuário: " + xhr.responseText);
        });

    }

</script>

</body>

</html>
